### Redis 分布锁

> 为了解决幂等性问题，在网上搜索了很多方法，发现Redis的分布锁不错，自己先测试下。

- 首先会查询key值存不存在
- 不存在就去setnx
- 如果key不存在，setnx成功，就去执行正常的操作，同时还要为key设置过期时间，否则可能发生死锁的情况
- 操作完成就去解锁

下图中总计发送了四次请求，虽然不是同一时间，但是模拟了并发的情况

![](test.png)